# Консольные утилиты для Evernote

Набор утилит для работы с сервисом заметок Evernote. Реализован запрос списка блокнотов, запрос и отображение текста заметок указанного блокнота, а также создание новой заметки.

## Требования

Должно быть установлены следующее ПО:

- [Python 2.x](https://www.python.org/)
- [Git](https://git-scm.com/download)

## Как установить

Скопируйте репозиторий удобным для вас способом.

Используйте `pip` для установки зависимостей:

```shell
pip install -r requirements.txt
```

## Создание ноутбука Evernote

Нужна учетная запись в https://evernote.com/. Для работы в песочнице зарегистрируйтесь на сервере разработки https://sandbox.evernote.com/Registration.action.

Для работы утилит необходимо создать в сервисе Evernote следующее:
1. Блокнот для входящих заметок
2. Блокнот для хранения заметок, например с именем "Дневник"
3. Пустая заметка-шаблон с заголовком "Заметка {date} {dow} #шаблон".

## Получение секретного токена

Зарегистрируйтесь на сервере разработки https://sandbox.evernote.com/Registration.action и получите токены.
Токены разработчика позволяют вам использовать API Evernote для доступа к вашей личной учетной записи Evernote. Чтобы узнать больше об использовании токенов разработчика, посетите dev.evernote.com.

Есть два варианта использования утилит с токеном разработчика.

### 1. В режиме разработки в "песочнице"

Получите токен разработчика для песочницы &ndash; https://dev.evernote.com/doc/articles/dev_tokens.php.

### 2. На продакшн сервере.

Чтобы использовать утилиты на продакшн сервере, нужно получить отдельный токен https://dev.evernote.com/doc/articles/dev_tokens.php. Однако сейчас автоматическое генерирование токенов для продакшн серверов не работает.
Для получения токена следуйте инструкции на [форуме Evernote](https://discussion.evernote.com/forums/topic/113349-developer-token-requests/).

## Переменные окружения

Настройки проекта берутся из переменных окружения. Чтобы их определить, создайте файл `.env` в корне проекта

Необходимые переменные:

```
EVERNOTE_CONSUMER_KEY=секретное слово
EVERNOTE_CONSUMER_SECRET=секретный ключ
EVERNOTE_PERSONAL_TOKEN=токен разработчика
JOURNAL_TEMPLATE_NOTE_GUID=идентификатор шаблонной заметки.
JOURNAL_NOTEBOOK_GUID=идентификатор блокнота, где создавать заметки.
INBOX_NOTEBOOK_GUID=идентификатор блокнота для входящих заметок.
```

Как получить идентификаторы см. ниже.

## Разработчикам

Реальные приложения должны использовать [OAuth](https://dev.evernote.com/doc/articles/authentication.php) вместе с ключом и секретом (https://dev.evernote.com/doc/), которые нужно добавить в `.env`:

- `EVERNOTE_CONSUMER_KEY`
- `EVERNOTE_CONSUMER_SECRET`


## Использование

В терминале перейдите в папку с проектом и введите команду. Вы получите список ваших блокнотов и их  GUID:

```shell
python2 list_notebooks.py
```

Для вывода информации о конкретных заметках, в том числе их GUID, используйте команду:

```shell
python2 dump_inbox.py
```

Для создания новой заметки из шаблонной. YYYY-MM-DD &ndash; дата (опционально).

```shell
python2 add_note2journal.py YYYY-MM-DD
```

## Как получить идентификаторы

Чтобы узнать все нужные идентификаторы (guid) следуйте инструкции:

1) Получите список всех созданных блокнотов. Вы получите GIUD для переменных `INBOX_NOTEBOOK_GUID` и `JOURNAL_NOTEBOOK_GUID`

```shell
❯ python list_notebooks.py
```

2) Получите идентификатор (GUID) заметки-шаблона (`JOURNAL_TEMPLATE_NOTE_GUID`)

```shell
❯ python dump_inbox.py 
```

## Модуль list_notebooks.py

Запрос и вывод списка блокнотов. Создается объект клиента `EvernoteClient` для работы с API Evernote и, с помощью метода `get_note_store` запрашивается список блокнотов. Далее он выводится вместе и идентификаторами (guid).

## Модуль dump_inbox.py

Запрос заметок из указанного блокнота и их печать в консоль. Использует метод `findNotesMetadata` и `NoteFilter` для указания идентификатора ноутбука и структуру `NotesMetadataResultSpec` для указания того что включать в результат поиска (заголовок, дату создания и пр.). Печатает текст заметок обработанный с помощью библиотеки `BeautifulSoup`.

## Модуль add_note2journal.py

Создание заметки с текстом из шаблона. Принимает аргументами дату (Необязательный аргумент, если не указать, то будет брать текущую дату). Создает объект клиента `EvernoteClient`, получает хранилище записей методом `get_note_store`, создает новую заметку путем копирования (`copyNote`) заметки-шаблона, вставляет в заголовок шаблона дату и день недели.


## Цели проекта

Учебный проект по работе с сервисом Evernote от онлайн-курса Devman (dvmn.org)